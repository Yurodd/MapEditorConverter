<section class="body_right_comment_input">

    <p>Your Scriptz:</p>
    <textarea id="user_script"></textarea>
     <button onclick="myFunction()">Click me</button>
     <p>Converted Scriptz:</p>
    <textarea id="converted_script"></textarea>
    <p>Wall Scriptz:</p>
    <textarea id="wall_script"></textarea>
   
    </br>

</section>

<script>
function myFunction() {

 var user_script = document.getElementById("user_script").value;
 var wall_script = document.getElementById("wall_script").value;
 
var user_scriptOnly = user_script.match(/(?:variables\n?{[\s\S]*?})?[\s]*(?:subroutines\n?{[\s\S]*?})?([\s\S]*)/)[1];
var user_varstring = user_script.match(/(?<=variables\n{)[\s\S]*?(?=})/)[0];
var user_varstring_full = user_script.match(/(?:variables\n{)[\s\S]*?(\n})/)[0];
var user_varstring_less = user_script.match(/(?:variables\n{)[\s\S]*?(\n})/)[0];
var user_globalstring = user_varstring.match(/(?<=global:\n)(?:\s+\d+: \S*?\n)*/)[0];
var user_playerstring = user_varstring.match(/(?<=player:\n)(?:\s+\d+: \S*?\n)*/)[0];
var user_globals = user_globalstring.matchAll(/\s+(\d+): (\S*)/g);
var user_players = user_playerstring.matchAll(/\s+(\d+): (\S*)/g);
user_globals = Array.from(user_globals);
user_players = Array.from(user_players);
var user_number=parseInt(user_globals[0][1],10);


var wall_scriptOnly = wall_script.match(/(?:variables\n?{[\s\S]*?})?[\s]*(?:subroutines\n?{[\s\S]*?})?([\s\S]*)/)[1];
var wall_varstring = wall_script.match(/(?<=variables\n{)[\s\S]*?(?=})/)[0];
var wall_varstring_full = wall_script.match(/(?:variables\n{)[\s\S]*?(\n})/)[0];
var wall_varstring_less = wall_script.match(/(?:variables\n{)[\s\S]*?(\n})/)[0];
var wall_globalstring = wall_varstring.match(/(?<=global:\n)(?:\s+\d+: \S*?\n)*/)[0];
var wall_playerstring = wall_varstring.match(/(?<=player:\n)(?:\s+\d+: \S*?\n)*/)[0];
var wall_globals = wall_globalstring.matchAll(/\s+(\d+): (\S*)/g);
var wall_players = wall_playerstring.matchAll(/\s+(\d+): (\S*)/g);
wall_globals = Array.from(wall_globals);
wall_players = Array.from(wall_players);
var wall_number=parseInt(wall_globals[0][1],10);

var newuserglobal = [];
var newuserplayer = [];
//////////////////////////////////////////////////////////////////////////

var index=0;
for(index; index < user_globals.length;index++)
{
newuserglobal[newuserglobal.length] = user_globals[newuserglobal.length][1] + ": " + user_globals[newuserglobal.length][2]
}

for(var i = 0; i < wall_globals.length; i++)
{
newuserglobal.push(parseInt(wall_globals[i][1],10) + index + ": " + wall_globals[i][2]);
}

index = 0;

//////////////////////////////////////////////////////////////////////////

for(index; index < user_players.length;index++)
{
newuserplayer[newuserplayer.length] = user_players[newuserplayer.length][1] + ": " + user_players[newuserplayer.length][2]
}

for(var i = 0; i < wall_players.length; i++)
{
newuserplayer.push(parseInt(wall_players[i][1],10) + index + ": " + wall_players[i][2]);
}

//////////////////////////////////////////////////////////////////////////
var text="variables\n{\n\tglobal:\n";
for(var i = 0; i<newuserglobal.length; i++)
{
text = text + "\t\t";
	text =  text + newuserglobal[i] + "\n";
}
text = text + "\n\tplayer:\n"
for(var i = 0; i<newuserplayer.length; i++)
{
	text = text + "\t\t";
	text =  text + newuserplayer[i] + "\n";
}
text = text + "}"

text = text + "\n\n" + user_scriptOnly;
document.getElementById("converted_script").innerHTML = text;

}
</script>
